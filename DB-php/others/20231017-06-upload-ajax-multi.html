<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .card-container {
        display: flex;
      }
      .my-card {
        width: 300px;
      }
      .my-card img {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div style="cursor: pointer;" onclick="photos.click()">點選上傳多張圖片</div>

    <form name="form1" hidden>
      <!-- 因為是多張圖片因此要用photos[] -->
      <input type="file" id="photos" name="photos[]" multiple accept="image/*" onchange="uploadFile()"/>
    </form>

    <div style="width: 300px">
      <img src="" alt="" />
    </div>
    <script>
      const container = document.querySelector(".card-container");
      function uploadFile() {
        const fd = new FormData(document.form1);

        fetch("upload-img-api-2.php", {
          method: "POST",
          body: fd,
        })
          .then((r) => r.json())
          .then((data) => {
            console.log({data});
            // 檔案成功傳送且這個檔案陣列有長度才執行
            if (data.success && data.files.length) {
              let str = "";
              // 設定str=img標籤+
              for (let i of data.files) {
                str += `
                <div class="my-card">
                  <img
                    src="./../uploads/${i}"
                    alt=""
                  />
                </div>
                `;
              }
              container.innerHTML = str;
            }
          });
        }
    </script>
  </body>
</html>
